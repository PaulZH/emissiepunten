
<link rel="import" href="../../bower_components/polymer/polymer.html"/>
<link rel="import" href="../app/app-styles.html?1.2.0"/>
<link rel="import" href="../../config/app-config.html?1.2.0"/>
<link rel="import" href="../app/behaviors/app-term-labels.html?1.2.0"/>
<link rel="import" href="../app/behaviors/app-linked-data-hrefs.html?1.2.0"/>
<dom-module id="ev-data-table">
<template>
<style include="app-styles">table{border-collapse:collapse;width:100%}th{text-align:left;background-color:var(--ev-app-grey-7);font-family:"Flanders Sans",Roboto-Light,sans-serif;font-weight:300;line-height:40px;padding:1px 16px 0;position:relative}td{line-height:32px;padding:0 16px;font-size:.9em}tbody tr:first-child td{padding-top:1em}tr+template+tr td,tr+tr td{border-top:1px solid var(--ev-app-grey-7)}td.label{font-weight:500;text-align:right;text-transform:capitalize;width:40%}a{color:var(--ev-app-green-1);text-transform:capitalize}.ld-link{display:block;position:absolute;right:8px;top:8px;width:24px;height:24px;background:transparent url(img/sw-cube.png) center no-repeat}</style>
<table>
<thead>
<tr>
<th colspan="2">
[[tableTitle]]
<a class="ld-link" href="[[ldHref(ldUri)]]" target="ev-ext" hidden$="[[!ldUri]]"></a>
</th>
</tr>
</thead>
<tbody>
<template is="dom-repeat" items="{{labelItems}}">
<tr>
<td class="label" title="{{item.labelUri}}">{{item.label}}</td>
<td>{{item.value}}</td>
</tr>
</template>
<template is="dom-repeat" items="{{textItems}}">
<tr>
<td class="label" title="{{item.labelUri}}">{{item.label}}</td>
<td>{{item.value}}</td>
</tr>
</template>
<template is="dom-repeat" items="{{linkItems}}">
<tr>
<td class="label" title="{{item.labelUri}}">{{item.label}}</td>
<td><a href="{{ldHref(item.valueUri)}}" target="ev-ext">{{item.value}}</a></td>
</tr>
</template>
</tbody>
</table>
</template>
<script>Polymer({is:"ev-data-table",behaviors:[appConfig,appTermLabels,appLinkedDataHrefs],ready:function(){this.setLinkedDataServers(this.config("linkedDataServers"))},properties:{termLabels:{type:Object},tableTitle:String,data:{type:Object,observer:"onData"},ldUri:{type:String,value:""},textItems:{type:Array,value:null},linkItems:{type:Array,value:null}},onData:function(e){var a,t=this,l=[],i=[],r=[],s=this.config("dataTableProperties").labels,p=this.config("dataTableProperties").skip;e.bindings.forEach(function(e){var u,n,o,v;u=t.getTermLabel(e.p.value),-1===p.indexOf(e.p.value)&&"bnode"!==e.o.type&&("http://purl.org/dc/terms/type"===e.p.value?n=t.getTermLabel(e.o.value):"uri"===e.o.type?(o=!0,n=e.oLabel?e.oLabel.value:t.getTermLabel(e.o.value)):n=e.o.value,v=-1!==s.indexOf(e.p.value),u===a&&(u=""),v&&l.length||(v?l.push({label:u,value:n,labelUri:e.p.value}):o?r.push({label:u,value:n,labelUri:e.p.value,valueUri:e.o.value}):i.push({label:u,value:n,labelUri:e.p.value}),a=u||a))}),this.set("labelItems",l),this.set("textItems",i),this.set("linkItems",r)}})</script>
</dom-module>
