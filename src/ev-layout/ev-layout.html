<!-- elements -->
<link rel="import" href="../../bower_components/polymer/polymer.html"/>
<link rel="import" href="../ev-global-header/ev-global-header.html"/>
<link rel="import" href="../ev-website-header/ev-website-header.html"/>
<link rel="import" href="../ev-app-canvas/ev-app-canvas.html"/>
<!-- styles -->
<link rel="import" href="../app/app-styles.html"/>
<!-- behaviors -->
<link rel="import" href="../behaviors/app-lazyloading.html"/>

<dom-module id="ev-layout">

    <template>
        <style include="app-styles">
            :host {
                display: block;
                min-height: 100vh;
            }

            ev-global-header,
            ev-website-footer {
                @apply(--ev-app-container);
            }

            ev-app-canvas {
                min-height: calc(100vh - 40px - 132px - 120px - 80px);
                padding-top: 40px;
                padding-bottom: 40px;
            }
        </style>

        <ev-global-header></ev-global-header>
        <ev-website-header></ev-website-header>
        <ev-app-canvas app="[[app]]"></ev-app-canvas>
    </template>

    <script>
        Polymer({

            is: 'ev-layout',

            behaviors: [
                appLazyloading
            ],

            properties: {
                app: String
            },

            attached: function () {
                // de-flag body to hide "loading" indicator
                document.querySelector("body").classList.remove('initializing');
                // render deferred elements
                this.async(this.renderDeferredElements, 1000);
            },

            /**
             * Defers expensive and/or less important elements
             */
            renderDeferredElements: function () {
                var self = this;
                this.lazyload(["../ev-website-footer/ev-website-footer.html"]).then(function () {
                    Polymer.dom(self.root).appendChild(document.createElement('ev-website-footer'));
                });
            }
        });
    </script>

</dom-module>
